<scene version="3.0.0">
	<path value=".."/>

	<default name="spp" value="512"/>
	<default name="res" value="512"/>
	<default name="polarization_angle" value="0"/>
	<default name="polarizing" value="true"/>

	<!-- Integrator -->
	<integrator type="volpath" id="integrator">
		<integer name="max_depth" value="-1"/>
	</integrator>

	<!-- Sensor -->
	<sensor type="perspective" id="sensor">
		<transform name="to_world">
			<lookat target="0, 0, 0" origin="0, 0, 75" up="0, 1, 0"/>
		</transform>

		<sampler type="independent">
			<integer name="sample_count" value="$spp"/>
		</sampler>

		<film type="hdrfilm">
			<integer name="width" value="$res"/>
			<integer name="height" value="$res"/>
		</film>
	</sensor>

	<!-- Head Object -->
	<include filename="scenes/centered_head_marcus.xml"/>

	<!-- Hair Materials -->
	<!-- <bsdf type="dielectric" id="hair_bsdf">
		<string name="int_ior" value="amber"/>
		<string name="ext_ior" value="air"/>
		<rgb name="specular_reflectance" value="0.0"/>
		<rgb name="specular_transmittance" value="0.65, 0.35, 0.15"/>
	</bsdf> -->
	<!-- <bsdf type="pplastic" id="hair_bsdf">
		<rgb name="diffuse_reflectance" value="0.65, 0.35, 0.15"/>
		<string name="int_ior" value="amber"/>
		<string name="ext_ior" value="air"/>
		<float name="alpha" value="0.3"/>
	</bsdf> -->
	<!-- <bsdf type="hair" id="hair_bsdf">
		<float name="eumelanin" value="0.11"/>
		<float name="pheomelanin" value="0.71"/>
	</bsdf> -->

	<bsdf type="blendbsdf" id="hair_bsdf">
		<float name="weight" value="0.5"/>

		<bsdf type="pplastic">
			<!-- <rgb name="diffuse_reflectance" value="0.65, 0.35, 0.15"/> -->
			<rgb name="diffuse_reflectance" value="0.143016, 0.0156076, 1.80928e-005"/>
			<string name="int_ior" value="amber"/>
			<string name="ext_ior" value="air"/>
			<float name="alpha" value="0.3"/>
			<string name="distribution" value="ggx"/>
		</bsdf>

		<bsdf type="dielectric">
			<string name="int_ior" value="amber"/>
			<string name="ext_ior" value="air"/>
			<rgb name="specular_reflectance" value="0.2"/>
		</bsdf>
	</bsdf>

	<medium type="homogeneous" id="hair_medium">
		<rgb name="albedo" value="0.9, 0.85, 0.8"/>
		<rgb name="sigma_t" value="0.1, 0.2, 0.5"/>
		
		<float name="scale" value="1"/>

		<boolean name="sample_emitters" value="false"/>
	</medium>

	<!-- Hair Object -->
	<shape type="bsplinecurve" id="hair">
		<string name="filename" value="hair_models/wWavy.txt"/>

		<!-- Transform for Straight Hair -->
		<!-- <transform name="to_world">
			<scale value="0.42"/>
			<rotate x="1" angle="270"/>
			<rotate y="1" angle="180"/>
			<translate x="-1.0" y="-5.8" z="-2.2"/>
		</transform> -->

		<!-- Transform for wWavy Hair -->
		<transform name="to_world">
			<scale value="0.315"/>
			<rotate x="1" angle="270"/>
			<rotate y="1" angle="270"/>
			<translate x="-0.8" y="0.5" z="0.5"/>
		</transform>

		<ref id="hair_bsdf"/>
	</shape>

	<!-- Light Sphere -->
	<shape type="sphere" id="light">
		<transform name="to_world">
			<scale value="200"/>
			<rotate x="1" angle="90"/>
		</transform>
		<boolean name="flip_normals" value="true"/>

		<emitter type="area">
			<rgb name="radiance" value="2"/>
		</emitter>

		<bsdf type="diffuse"/>
	</shape>

	<!-- Polarizers -->
	<shape type="sphere" id="polarizer_light">
		<transform name="to_world">
			<scale value="190"/>
			<rotate x="1" angle="90"/>
		</transform>

		<bsdf type="polarizer">
			<spectrum name="theta" value="90"/>
			<boolean name="polarizing" value="$polarizing"/>
		</bsdf>
	</shape>

	<shape type="rectangle" id="polarizer_cam">
		<transform name="to_world">
			<rotate z="1" angle="90"/>
			<lookat target="0, 0, 0" origin="0, 0, 100000" up="0, 1, 0"/>
		</transform>

		<bsdf type="polarizer">
			<spectrum name="theta" value="$polarization_angle"/>
			<boolean name="polarizing" value="$polarizing"/>
		</bsdf>
	</shape>
</scene>